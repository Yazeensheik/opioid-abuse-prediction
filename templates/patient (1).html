<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <!-- My CSS -->
    <link rel="stylesheet" href="patient.css">

    <title>Patient's Log</title>
</head>
<style>

    /* Wrapper Styles */
    .wrapper {
        width: 500px;
        max-width: 800px;
        background: #ffffff;
        border-radius: 15px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 30px;
        animation: fadeIn 1s ease-in-out;
    }

    /* Title Styles */
    .wrapper .title {
        font-size: 2rem;
        font-weight: 900;
        text-align: center;
        color: #ffffff;
        background: #00c389;
        padding: 20px;
        border-radius: 15px 15px 0 0;
        margin: -30px -30px 30px -30px; /* Adjust margin to fit wrapper */
        box-sizing: border-box;
    }

    /* Container Styles */
    .container {
        text-align: center;
    }

    /* Button Styles */
    button {
        padding: 10px 20px;
        font-size: 16px;
        color: #ffffff;
        background-color: #00c389;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    button:hover {
        background-color: #008f6b;
    }

    button:focus {
        outline: none;
    }

    /* Keyframes for fade-in animation */
    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
</style>
<body>

    <!-- SIDEBAR -->
    <section id="sidebar">
        <a href="#" class="brand">
            <i class='bx bx-universal-access'></i>
            <span class="text">Patient's Log</span>
        </a>
        <ul class="side-menu top">
            <li>
                <a href="#Report-Upload-id">
                    <i class='bx bx-file'></i>
                    <span class="text">Report Upload</span>
                </a>
            </li>
            <li>
                <a href="#Self-Analysis-id">
                    <i class='bx bx-user'></i>
                    <span class="text">Self Analysis</span>
                </a>
            </li>
        </ul>

        <ul class="side-menu">
            <li>
                <a href="patient_login.html" class="logout">
                    <i class='bx bx-log-out'></i>
                    <span class="text">Logout</span>
                </a>
            </li>
        </ul>
    </section>
    <!-- SIDEBAR -->

    <!-- CONTENT -->
    <section id="content">
        <!-- NAVBAR -->
        <nav>
            <i class='bx bx-menu'></i>
            <a href="#" class="nav-link">Categories</a>
            <a href="#" class="profile">
                <img src="man.png" alt="Profile">
            </a>
        </nav>
        <!-- NAVBAR -->

        <!-- MAIN -->

        <main id="Report-Upload"></main>
        <div class="wrapper">
            <div class="title">Generate Medical Report</div>
            <div class="container">
                <button id="generate-report-btn">Generate Report</button>
            </div>
        </div>
        </main>
        <main id="Self-Analysis">
            <div class="container">
                <div class="wrapper">
                    <div class="title">SELF ANALYSIS</div>
                    <form id="self-analysis-form" class="form-container">

                        <div class="input-field">
                            <label for="age">Age</label>
                            <input placeholder="Age in years" name="Age" id="age" type="text" class="validate">
                        </div>

                        <div class="input-field">
                            <label for="gender">Gender</label>
                            <br>
                            <label><input name="Gender" type="radio" value="Male" /> Male</label>
                            <label><input name="Gender" type="radio" value="Female" /> Female</label>
                        </div>

                        <div class="input-field">
                            <label for="family_substance_abuse">Family History of Substance Abuse</label>
                            <br>
                            <label><input name="Family History of Substance Abuse" type="radio" value="Yes" /> Yes</label>
                            <label><input name="Family History of Substance Abuse" type="radio" value="No" /> No</label>
                        </div>

                        <div class="input-field">
                            <label for="personal_substance_abuse">Personal History of Substance Abuse</label>
                            <br>
                            <label><input name="Personal History of Substance Abuse" type="radio" value="Yes" /> Yes</label>
                            <label><input name="Personal History of Substance Abuse" type="radio" value="No" /> No</label>
                        </div>

                        <div class="input-field">
                            <label for="mental_health_conditions">History of Mental Health Conditions</label>
                            <br>
                            <label><input name="History of Mental Health Conditions" type="radio" value="Yes" /> Yes</label>
                            <label><input name="History of Mental Health Conditions" type="radio" value="No" /> No</label>
                        </div>

                        <div class="input-field">
                            <label for="chronic_pain_conditions">Chronic Pain Conditions</label>
                            <br>
                            <label><input name="Chronic Pain Conditions" type="radio" value="Yes" /> Yes</label>
                            <label><input name="Chronic Pain Conditions" type="radio" value="No" /> No</label>
                        </div>

                        <div class="input-field">
                            <label for="prescribed_medications">Prescribed Medications</label>
                            <select name="Prescribed Medications" id="prescribed_medications" class="validate">
                                <option value="" disabled selected>Select Medication</option>
                                <option value="Kadian">Kadian</option>
                                <option value="Hydrocodone">Hydrocodone</option>
                                <option value="Codeine">Codeine</option>
                                <option value="Oxycodone">Oxycodone</option>
                                <option value="Methadone">Methadone</option>
                                <option value="Vicodin">Vicodin</option>
                                <option value="Fentanyl">Fentanyl</option>
                                <option value="Tramadol">Tramadol</option>
                                <option value="Morphine">Morphine</option>
                                <option value="Demerol">Demerol</option>
                                <option value="Opana">Opana</option>
                            </select>
                        </div>

                        <div class="input-field">
                            <label for="dosage">Dosage</label>
                            <select name="Dosage" id="dosage" class="validate">
                                <option value="" disabled selected>Select Dosage</option>
                                <option value="25mcg/hour patch">25mcg/hour patch</option>
                                <option value="10mg">10mg</option>
                                <option value="5mg">5mg</option>
                                <option value="50mg">50mg</option>
                            </select>
                        </div>

                        <div class="input-field">
                            <label for="frequency">Frequency</label>
                            <select name="Frequency" id="frequency" class="validate">
                                <option value="" disabled selected>Select Frequency</option>
                                <option value="2 times per day">2 times per day</option>
                                <option value="3 times per day">3 times per day</option>
                                <option value="4 times per day">4 times per day</option>
                                <option value="changed every 72 hours">Changed every 72 hours</option>
                            </select>
                        </div>

                        <div class="input-field">
                            <label for="duration_opioid_use">Duration of Opioid Medication Use</label>
                            <select name="Duration of Opioid Medication Use" id="duration_opioid_use" class="validate">
                                <option value="" disabled selected>Select Duration</option>
                                <option value="1 month">1 month</option>
                                <option value="2 months">2 months</option>
                                <option value="3 months">3 months</option>
                                <option value="4 months">4 months</option>
                                <option value="6 months">6 months</option>
                                <option value="1 year">1 year</option>
                                <option value="2 years">2 years</option>
                                <option value="3 years">3 years</option>
                            </select>
                        </div>

                        <div class="input-field">
                            <label for="overdose_history">History of Overdose or Hospitalization Due to Opioid Use</label>
                            <br>
                            <label><input name="History of Overdose or Hospitalization Due to Opioid Use" type="radio" value="Yes" /> Yes</label>
                            <label><input name="History of Overdose or Hospitalization Due to Opioid Use" type="radio" value="No" /> No</label>
                        </div>

                        <div class="input-field">
                            <label for="social_support">Social Support Network</label>
                            <select name="Social Support Network" id="social_support" class="validate">
                                <option value="" disabled selected>Select Support System</option>
                                <option value="Strong support system">Strong support system</option>
                                <option value="Moderate support system">Moderate support system</option>
                                <option value="Limited support system">Limited support system</option>
                            </select>
                        </div>

                        <div class="center">
                            <button type="submit" class="btn-large waves-effect waves-light orange">Predict Score</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
        <!-- MAIN -->
    </section>
    <!-- CONTENT -->

    <script src="patient.js"></script>
    <script>
        document.getElementById('download-btn').addEventListener('click', function() {
            const patientId = localStorage.getItem('patient_id');
            if (patientId) {
                window.location.href = `http://localhost:5000/download/${patientId}`;
            } else {
                alert('Patient ID not found in local storage.');
            }
        });
        document.getElementById('self-analysis-form').addEventListener('submit', function (event) {
            event.preventDefault();  // Prevent the default form submission

            // Collect form data
            const formData = new FormData(event.target);
            const data = {};

            // Convert form data into JSON format
            formData.forEach((value, key) => {
                data[key] = value;
            });

            // Send the data to the backend as JSON
            fetch('http://127.0.0.1:5000/self_analysis', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(data => {
                // Handle the response from the backend
                alert(`Predicted Risk Level: ${data.risk_level}`);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });    </script>
</body>

</html>
